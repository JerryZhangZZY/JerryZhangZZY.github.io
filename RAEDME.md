Modified from http://gobupt.onebug.tech/
Improved by @ZaitianWang
